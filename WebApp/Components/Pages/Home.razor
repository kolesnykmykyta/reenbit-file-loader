@page "/"
@rendermode InteractiveServer
@inject IBlobStorageService blobStorageService

<PageTitle>File Upload</PageTitle>

<div>
    <div>
        <div class="mt-2">
            <label for="emailField">Email</label>
            <input id="emailField" type="text" class="form-control" @bind="@Email" />
        </div>
        <div class="mt-2">
            <label for="fileField">File (.docx only)</label>
            <InputFile id="fileField" class="form-control" OnChange="@LoadFile" />
        </div>
        <div class="d-flex flex-row-reverse">
            <button @onclick="SubmitFormAsync">Submit</button>
        </div>
    </div>
</div>
<p>@counter</p>



@code {
    private string? Email { get; set; }
    private IBrowserFile? File { get; set; }
    private string Message { get; set; }
    private int counter = 0;

    private void LoadFile(InputFileChangeEventArgs e)
    {
        File = e.GetMultipleFiles()[0];
    }

    private async void SubmitFormAsync()
    {
        await blobStorageService.UploadFileToStorageAsync(File!.OpenReadStream(), File!.Name, Email!);
    }
}
